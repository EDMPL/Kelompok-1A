<!doctype html>
<html>
  <head>
    <style>
      #map {
		  width: 700px;
		  height: 500px;
		  border: 1px solid #a0a0a0;
		}
    </style>
  </head>
  <body>
    <div id="map">Maps Event</div>

    <!-- Google Maps JS API -->
    <script src="https://maps.googleapis.com/maps/api/js"></script>
    <!-- GMaps Library -->
    <script src="gmaps.js"></script>
    <!--<div class="row">
        <label for="loc_text"><span style="font-size: 13px;">Enter Transportation Mode:</span></label>
		<form id="transMode">
		<input type="text" id="transMode">
		<input type="submit" value="submita">
		</form>
      </div>-->
	<script>
            var marker1 = null, marker2 = null;
            var marker1pos, marker2pos;
            var a = false, b = true;
            var map = new GMaps({
                el: '#map',
                lat: 41.8902421, //latitude awal
                lng: 12.4924991, //longitude awal
                zoom: 12,
                click: function(e) {
                    if (a) {
                        map.removeMarker((b) ? marker1 : marker2); //jika false, hapus marker dari lokasi sebelumnya
                        map.removePolylines(); //menghapus garis rute
                    }

                    if (b) {
                        //menempatkan marker
                        marker1 = map.addMarker({
                        lat: e.latLng.lat(),//latitude dari lokasi awal
                        lng: e.latLng.lng()//longitude dari lokasi awal
                        //icon: sourceIcon
                        });
                    marker1pos = marker1.getPosition();
                    } 
                    else {
                        //menempatkan marker
                        marker2 = map.addMarker({
                        lat: e.latLng.lat(),//latitude dari lokasi tujuan
                        lng: e.latLng.lng()//longitude dari lokasi tujuan
                        //icon: destinationIcon
                        });
                        marker2pos = marker2.getPosition();
                    }
                    // jika kedua marker sudah ditempatkan, langsung gambar rute
                    if (marker1 !== null && marker2 !== null) {
                        a = true;
                        //menggambar rute dari dua marker
                        map.drawRoute({
                            origin: [marker1pos.lat(), marker1pos.lng()], //lokasi awal
                            destination: [marker2pos.lat(), marker2pos.lng()],//lokasi tujuan
                            travelMode: 'driving', //bisa diganti menjadi 'walking' atau 'transit'
                            strokeColor: '#131540',
                            strokeOpacity: 0.6,
                            strokeWeight: 6
                        });
                    }
                    b = !b;
                }
            });
            
            GMaps.geolocate({
                success: function(position) {
                  map.setCenter(position.coords.latitude, position.coords.longitude);
                },
                error: function(error) {
                  alert('Geolocation failed: ' + error.message);
                },
                not_supported: function() {
                  alert("Your browser does not support geolocation");
                }
            });
	</script>
  </body>
</html>
